<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>BIGBASE BINGO</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
/* =========================================================
   ğŸ¨ ç‰ˆé¢èˆ‡èƒŒæ™¯ï¼ˆæ·±è‰²ç²‰ç­†é¢¨ï¼‰
   ========================================================= */
html, body { height: 100%; margin: 0; }
body{
  font-family:'Chalkboard','Comic Sans MS',system-ui,-apple-system,sans-serif;
  background:
    radial-gradient(1200px 800px at 50% 10%, #4b3a39 0%, #342626 60%, #2a1e1e 100%),
    linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.05));
  color:#fff;
}

/* å…¨é ç½®ä¸­ */
.page{ min-height:100svh; display:grid; place-items:center; padding:18px; }

/* å·¦å³å…©æ¬„ï¼šå·¦è¨­å®šã€å³è³“æœç›¤ */
.app{
  display:flex;
  align-items:flex-start;
  gap:40px;
  max-width:1150px;
}

/* =========================================================
   ğŸ“‹ å·¦å´è¨­å®šæ¬„
   ========================================================= */
#settings{
  position:relative;
  flex:0 0 380px;
  background:#4a3b30;
  border-right:3px solid #2a1f18;
  padding:20px;
  box-sizing:border-box;
  box-shadow:inset -3px 0 8px rgba(0,0,0,.5);
  display:flex; flex-direction:column;
  overflow-y:auto;
  overflow-x:hidden;
  line-height:1.55;
  scrollbar-width:thin;
}

#settings h2{
  font-size:22px; color:#ffcc66;
  text-shadow:1px 1px 2px #000; margin:0 0 10px;
  display:flex; align-items:center; justify-content:space-between;
}

/* ğŸ“¸ æˆªåœ–æŒ‰éˆ•ï¼ˆä½ åŸæœ‰çš„ï¼‰ */
#captureBtn{
  background:#6b513c; color:#fff; border:none;
  padding:6px 10px; border-radius:6px;
  font-size:14px; cursor:pointer; transition:background .2s;
}
#captureBtn:hover{ background:#8a6a51; }

label{ font-size:14px; opacity:.9; }

/* éŠæˆ² ID */
#gameIdInput{
  width:90%; padding:8px 10px; margin:6px auto 12px;
  border:none; border-radius:6px; background:#6a4e3a; color:#fff;
  text-align:center; font-size:14px;
}

button{
  background:#7c5c45; color:#fff; border:none;
  padding:10px 12px; margin:6px 0; cursor:pointer;
  font-size:16px; border-radius:8px; transition:background .2s;
}
button:hover{ background:#a47d5f; }

.hint{
  margin-top:10px; font-size:13px; line-height:1.4;
  color:#ffd99a; opacity:.9;
}

/* è¦å‰‡æ®µè½èˆ‡é–“è·ï¼ˆç…§ä½ ä¹‹å‰ï¼‰ */
#settings .rules { margin-top:0; padding-top:0; }
#settings .rules h3{ margin-top:6px; margin-bottom:6px; }
#settings .rules p{ font-size:14px; color:#fff; margin:4px 0 10px; }
#settings hr{ border:1px dashed #7a5d43; opacity:.8; margin:6px 0; }
#settings .rules h3:first-child{ margin-top:0; }

/* æ»¾å‹•é™°å½± */
#settings::before, #settings::after{
  content:""; position:absolute; left:0; right:0; height:14px;
  pointer-events:none; opacity:0; transition:opacity .18s ease;
}
#settings::before{ top:0; background:linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,0)); }
#settings::after { bottom:0; background:linear-gradient(to top, rgba(0,0,0,.45), rgba(0,0,0,0)); }
#settings.shadow-top::before{ opacity:1; }
#settings.shadow-bottom::after{ opacity:1; }

/* =========================================================
   ğŸ¯ è³“æœç›¤å€åŸŸ
   ========================================================= */
.board-wrap{ position:relative; padding:8px 0 24px 24px; }

.board-header{ display:flex; justify-content:flex-start; align-items:flex-start; margin:0 0 10px 0; }
.title-stack{ display:flex; flex-direction:column; gap:4px; }

#title{
  font-size:46px; color:#fff; font-weight:800; letter-spacing:3px;
  text-shadow:2px 2px 5px #000; user-select:none; margin:0;
}
#title, #gameIdDisplay{
  text-shadow:
    0 0 1px rgba(255,255,255,.85),
    0 0 6px rgba(255,255,255,.28),
    2px 2px 0 rgba(0,0,0,.35);
}
#gameIdDisplay{
  font-size:24px; line-height:1; color:#ffcc66;
  text-shadow:
    0 0 1px rgba(255,240,200,.9),
    0 0 5px rgba(255,220,150,.25),
    1px 1px 0 rgba(0,0,0,.35);
}

/* è³“æœç›¤ */
#bingo-board{
  display:grid; width:fit-content;
  grid-template-columns:repeat(5,80px);
  grid-template-rows:repeat(5,80px);
  gap:4px; background:#2d2d2d; padding:16px; border-radius:12px;
  box-shadow:0 0 10px #000 inset;
}
.cell{
  display:flex; justify-content:center; align-items:center;
  font-size:28px; border-radius:8px; background:rgba(255,255,255,0.06);
  text-shadow:1px 1px 3px #000; cursor:pointer;
}
.cell:focus{ outline:2px dashed #ffcc66; outline-offset:2px; }
.cell-editor{
  width:100%; height:100%; border:none; border-radius:8px;
  background:rgba(0,0,0,.35); color:#fff; text-align:center; font-size:26px;
}

/* é¡è‰² */
.color1{ color:#ff6666; } .color2{ color:#ffcc33; }
.color3{ color:#66ffff; } .color4{ color:#cc99ff; }
.color5{ color:#99ff99; }

/* ä½œè€… + æ–°å¢ Birk å€å¡Š */
.meta{
  margin-top:12px; text-align:left;
  position: relative;          /* è®“å³å´å€å¡Šå¯è²¼é½Šåº•éƒ¨ */
  min-height: 160px;           /* ç¢ºä¿é«˜åº¦èƒ½å®¹ç´å·¦åœ– */
}
.meta .author{ font-size:14px; color:#ffd99a; }
.meta .author-img{
  margin-top:6px; width:140px; height:auto;
  border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.4);
}

/* å³å´ï¼šå¹¸é‹æ•¸å­— + ç¶¿ç¾Š GIFï¼ˆèˆ‡å·¦åœ–åº•éƒ¨è²¼é½Šï¼‰ */
.birk-zone{
  position:absolute;
  right:10px;         /* â¬… èª¿æ•´è·é›¢å·¦å´ï¼Œè®“ç¶¿ç¾Šé è¿‘ä¼éµ */
  bottom:25px;            /* GIFé«˜åº¦èª¿æ•´ */
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
}
.lucky-text{
  font-size:16px; color:#ffec99; font-weight:600;
  text-shadow:1px 1px 2px #000;
}
.birk-img{
  width:110px; height:auto; image-rendering:pixelated;
}

/* ğŸ“£ æˆªåœ–å®Œæˆæç¤ºï¼ˆå³ä¸‹è§’æµ®å‡ºï¼‰ */
#toast{
  position:fixed; right:22px; bottom:22px; z-index:9999;
  background:rgba(30,30,30,.92); color:#fff; padding:10px 14px;
  border-radius:10px; box-shadow:0 6px 16px rgba(0,0,0,.35);
  font-size:14px; opacity:0; transform:translateY(8px);
  pointer-events:none; transition:opacity .2s ease, transform .2s ease;
}
#toast.show{ opacity:1; transform:translateY(0); }
</style>
</head>
<body>
<div class="page">
  <div class="app">
    <!-- å·¦ï¼šè¨­å®šæ¬„ -->
    <aside id="settings">
      <h2>
        è¨­å®š
        <button id="captureBtn">ğŸ“¸ æˆªåœ–</button>
      </h2>

      <label for="gameIdInput">éŠæˆ² ID</label>
      <input id="gameIdInput" type="text" placeholder="ä¾‹å¦‚ï¼šPiiBow" maxlength="16" />
      <button id="btnRandom">ğŸ² ç”Ÿæˆäº‚æ•¸è³“æœç›¤</button>

      <div class="hint">
        â€¢ é»æ“Šè³“æœç›¤ä»»ä¸€æ ¼ï¼Œå¯ç›´æ¥è¼¸å…¥ 0â€“100 çš„æ•¸å­—ã€‚<br>
        â€¢ ç³»çµ±æœƒæª¢æŸ¥ã€Œä¸é‡è¤‡ã€èˆ‡ã€Œæ•¸å€¼ç¯„åœã€ã€‚<br>
        â€¢ è‹¥è¼¸å…¥é‡è¤‡æˆ–è¶…å‡ºç¯„åœï¼Œæœƒé€€å›åŸå€¼ä¸¦æç¤ºã€‚
      </div>

      <hr>

      <div class="rules">
        <h3 style="color:#ffd966; font-size:20px;">ğŸ’° ä¸»è¦çå‹µ</h3>
        <p>ğŸ† ç¬¬ä¸€ä½å®Œæˆäº”æ¢ç·š â†’ <b>150 é›ªèŠ± â„ï¸</b><br>
           ğŸ¥ˆ ç¬¬äºŒä½å®Œæˆäº”æ¢ç·š â†’ <b>100 é›ªèŠ± â„ï¸</b><br>
           ğŸ¥‰ ç¬¬ä¸‰ä½å®Œæˆäº”æ¢ç·š â†’ <b>75 é›ªèŠ± â„ï¸</b><br>
           ğŸŒŸ ç¬¬å››ä½å®Œæˆäº”æ¢ç·š â†’ <b>50 é›ªèŠ± â„ï¸</b></p>

        <hr>

        <h3 style="color:#ffd966; font-size:20px;">ğŸŒŸ é¡å¤–ç·šçï¼ˆå‰ä¸‰æ¢ç·šé™å®šï¼‰</h3>
        <p>âš¡ ç¬¬ä¸€ã€ç¬¬äºŒã€ç¬¬ä¸‰æ¢ç·šå‡ºç¾æ™‚ï¼Œå‡¡è©²å›åˆä¸­ã€Œæœ€å…ˆå–Šå‡º Bingoï¼ã€è€…ï¼Œå‡å¯ç²å¾— <b>5 é›ªèŠ± â„ï¸</b>ã€‚<br><br>
           âš¡ è‹¥åŒæ™‚å¤šäººå–Šå‡ºï¼Œè©²æ¢ç·šæ‰€æœ‰äººçš†å¾—çã€‚<br><br>
           âš¡ æ¯æ¢ç·šçå‹µåƒ…ç™¼ä¸€æ¬¡ï¼Œç¬¬4æ¢ä»¥å¾Œä¸å†ç™¼æ”¾ã€‚<br><br>
           âš¡ ä»¥éŠæˆ²æˆ– Discord èªéŸ³å–Šè²æ™‚é–“ç‚ºæº–ã€‚</p>

        <hr>

        <h3 style="color:#ffd966; font-size:20px;">âœ¨ é»ƒé‡‘æ•¸å­—çå‹µ</h3>
        <p>ï¼ˆæ¯”è³½å‰å…¬é–‹æŠ½å‡ºï¼Œå…¨å“¡å…±ç”¨ï¼‰<br><br>
           ä¸­ 1 å€‹ â†’ <b>5 é›ªèŠ± â„ï¸</b><br>
           ä¸­ 2 å€‹ â†’ <b>10 é›ªèŠ± â„ï¸</b><br>
           ä¸­ 3 å€‹ â†’ <b>15 é›ªèŠ± â„ï¸</b><br>
           ä¸­ 4 å€‹ â†’ <b>20 é›ªèŠ± â„ï¸</b><br>
           ä¸­ 5 å€‹ â†’ <b>50 é›ªèŠ± â„ï¸</b></p>
      </div>
    </aside>

    <!-- å³ï¼šè³“æœç›¤ -->
    <main class="board-wrap" id="boardArea">
      <div class="board-header">
        <div class="title-stack">
          <h1 id="title">BIGBASE BINGO</h1>
          <div id="gameIdDisplay"></div>
        </div>
      </div>

      <div id="bingo-board"></div>

      <div class="meta">
        <div class="author">è£½ä½œè€…ï¼šé‡‘é»ƒè‰¾æ‹‰ä¼éµ</div>
        <img class="author-img" src="https://i.ibb.co/mrL4RZQD/2025-10-15-230345.png" alt="ä½œè€…åœ–ç‰‡"/>

        <!-- âœ… æ–°å¢ï¼šå³å´å¹¸é‹æ•¸å­— + Birk GIFï¼ˆè²¼é½Šå·¦åœ–åº•éƒ¨ï¼‰ -->
        <div class="birk-zone">
          <div class="lucky-text" id="luckyNum">ä»Šæ—¥å¹¸é‹æ•¸å­—ï¼š--</div>
          <img class="birk-img" src="https://www.artalemaplestory.com/images/monsters/birk.gif" alt="Birk">
        </div>
      </div>
    </main>
  </div>
</div>

<!-- ğŸ“£ æç¤ºå®¹å™¨ -->
<div id="toast" role="status" aria-live="polite"></div>

<script>
/* === ä½ çš„åŸç¨‹å¼ï¼šè³“æœç›¤éš¨æ©Ÿ / ç·¨è¼¯ï¼ˆä¿ç•™ä¸æ”¹ï¼‰ === */
const board=document.getElementById('bingo-board');
const gameIdInput=document.getElementById('gameIdInput');
const gameIdDisplay=document.getElementById('gameIdDisplay');
const btn=document.getElementById('btnRandom');

gameIdInput.addEventListener('input',()=>{
  let v=gameIdInput.value;
  if(v.length>16){v=v.slice(0,16);gameIdInput.value=v;}
  gameIdDisplay.textContent=v.trim();
});

function generateRandomBingo(){
  const arr=[];
  while(arr.length<25){
    const n=Math.floor(Math.random()*101);
    if(!arr.includes(n))arr.push(n);
  }
  board.innerHTML='';
  arr.forEach((n,i)=>{
    const c=document.createElement('div');
    c.className='cell color'+((i%5)+1);
    c.textContent=n;
    c.tabIndex=0;
    c.addEventListener('click',()=>editCell(c));
    c.addEventListener('keydown',e=>{if(e.key==='Enter')editCell(c);});
    board.appendChild(c);
  });
}
btn.addEventListener('click',generateRandomBingo);

function editCell(c){
  if(c.querySelector('input'))return;
  const o=c.textContent;
  const e=document.createElement('input');
  e.type='number'; e.min=0; e.max=100;
  e.className='cell-editor'; e.value=o;
  c.textContent=''; c.appendChild(e); e.focus(); e.select();
  const cancel=()=>{c.removeChild(e);c.textContent=o;};
  const commit=()=>{
    const v=e.value.trim();
    if(v===''){ cancel(); return; }
    const n=Number(v);
    if(!Number.isInteger(n)||n<0||n>100){ alert('è«‹è¼¸å…¥ 0â€“100 æ•´æ•¸'); cancel(); return; }
    const all=[...board.children].map(x=>Number(x.textContent||(x.querySelector('input')?.value??'')));
    const idx=[...board.children].indexOf(c); all.splice(idx,1);
    if(all.includes(n)){ alert('æ•¸å­—é‡è¤‡'); cancel(); return; }
    c.removeChild(e); c.textContent=String(n);
  };
  e.addEventListener('blur',commit);
  e.addEventListener('keydown',k=>{ if(k.key==='Enter')commit(); else if(k.key==='Escape')cancel(); });
}
generateRandomBingo();

/* è¨­å®šæ¬„é«˜åº¦èˆ‡å³å´é½Šå¹³ + æ»¾å‹•é™°å½±ï¼ˆç…§ä½ çš„ï¼‰ */
(function(){
  const s=document.getElementById('settings');
  const r=document.querySelector('.board-wrap');
  function setH(){ const h=Math.ceil(r.getBoundingClientRect().height); s.style.maxHeight=(h-12)+'px'; updateShadow(); }
  window.addEventListener('load',setH);
  window.addEventListener('resize',setH);
  function updateShadow(){
    const atTop=s.scrollTop<=0;
    const atBottom=s.scrollHeight-s.clientHeight-s.scrollTop<=1;
    s.classList.toggle('shadow-top',!atTop);
    s.classList.toggle('shadow-bottom',!atBottom);
  }
  s.addEventListener('scroll',updateShadow);
  setH();
})();

/* === ğŸ“¸ æˆªåœ–æç¤º === */
function showToast(msg){
  const t=document.getElementById('toast');
  if(!t)return;
  t.textContent=msg;
  t.classList.add('show');
  clearTimeout(showToast._timer);
  showToast._timer=setTimeout(()=>t.classList.remove('show'),1800);
}

/* === ğŸ“¸ æˆªåœ–ï¼ˆä¸å«ä½œè€…ã€å››é‚Šç•™ç™½ã€æ­£æ–¹å½¢ï¼‰ === */
document.getElementById('captureBtn').addEventListener('click',()=>{
  const boardArea=document.getElementById('boardArea');
  const clone=boardArea.cloneNode(true);
  const meta=clone.querySelector('.meta'); if(meta) meta.remove();
  const stage=document.createElement('div');
  stage.style.position='fixed'; stage.style.left='-99999px'; stage.style.top='0';
  stage.style.background='radial-gradient(1200px 800px at 50% 10%, #4b3a39 0%, #342626 60%, #2a1e1e 100%),linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.05))';
  stage.style.display='flex'; stage.style.justifyContent='center'; stage.style.alignItems='center';
  clone.style.margin='0 auto'; clone.style.width='fit-content';
  stage.appendChild(clone); document.body.appendChild(stage);

  let t=80,b=80,l=60,r=60;
  const w=clone.scrollWidth, h=clone.scrollHeight;
  let W=w+l+r, H=h+t+b;
  if(W>H){const ex=(W-H)/2; t+=ex; b+=ex;}
  else if(H>W){const ex=(H-W)/2; l+=ex; r+=ex;}
  stage.style.padding=`${t}px ${r}px ${b}px ${l}px`;

  html2canvas(stage,{backgroundColor:null, scale:2, useCORS:true,
                     width:Math.ceil(w+l+r), height:Math.ceil(h+t+b)}).then(canvas=>{
    const raw=(document.getElementById('gameIdInput')?.value||'').trim().slice(0,16);
    const safe=raw.replace(/[\\/:*?"<>|]+/g,'').trim();
    const filename=safe?`BIGBASE-${safe}.png`:'BIGBASE.png';
    const link=document.createElement('a');
    link.download=filename; link.href=canvas.toDataURL('image/png'); link.click();
    showToast('âœ… å·²å„²å­˜ï¼š'+filename);
    document.body.removeChild(stage);
  }).catch(()=>{
    document.body.removeChild(stage);
    alert('æˆªåœ–æ™‚ç™¼ç”Ÿå•é¡Œï¼Œè«‹å†è©¦ä¸€æ¬¡');
  });
});

/* === âœ… å¹¸é‹æ•¸å­—ï¼ˆè¼‰å…¥æ™‚è‡ªå‹• 0â€“100ï¼‰ === */
(function(){
  const lucky=document.getElementById('luckyNum');
  if(lucky){
    const n=Math.floor(Math.random()*101);
    lucky.textContent='ä»Šæ—¥å¹¸é‹æ•¸å­—ï¼š'+n;
  }
})();
</script>
</body>
</html>

